webpackJsonp([1],{"5Ejt":function(e,t){},N88Y:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABnElEQVR42mNgGAXkAWkgtgVifyi2hYrRHCgA8S4g/gHEv4H4DxT/hortBGJ5WljMB8QtQPwWiP8TwG+AuAmIeallOQsQzwPif0RYDsMgtTOBmJlSy0EG9ADxXxIsh2GQng4gZqLEAQZA/J4My2EYFGU6lDgAX9D/BOIdUPwTT1RMpSThfcdhKCi1yyGpBaX8PTgc+xGIOclxgBMen6thUa8FxL9w6LEkxwExOAy7hkM9IxDfxaEnjBwHROMw7BIePVdw6IkmxwG2eKJAHYt6TTyJ0ZocB/BCi1dsiXAjEEtAywlQQSUJxFtxJEJQQuYmNydswJPHHwPxfih+gkfdGkrKAW9oRUNuQQTKFe6UOEAciO9T4ABQrhCltD7opMABTdSoDdmA+AUZlj+iRm0IA2nQhgexloPSTQI1GyT8eEo5bPgmEPNQu1VkCMSfiLD8PbReoAloJsIB1bRslAoC8R08ll+iZlsQFwDV/U+xWH4fWm7QBaRhcUAUPTsmTNDG6m9oDVg3EL0jDiDeC60ZWQeqiwaqhoVGe6qUAAA6hy6Gh5Xh9QAAAABJRU5ErkJggg=="},NHnr:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i("7+uW"),n=i("zL8q"),s=i.n(n),o=(i("tvR6"),i("/ocq")),r=i("9bGr"),c=i("gCHX"),l=i("L2CZ"),u=i("1Cty"),h=i("aC3Q"),d=i("eM/O"),f=i("bdNf"),w=i("86p+"),A=i("tOEd"),g=i("6HMI"),p=i("lY9i"),v=i("zOBh"),m=i("HWXU"),b=i("oj2/"),x=(i("ktr9"),i("N88Y")),B=i.n(x),U=i("tYJ7"),k=i.n(U),y="//www.google.cn/maps/vt/pb=!1m4!1m3!1i{z}!2i{x}!3i{y}!2m3!1e0!2sm!3i380072576!3m8!2szh-CN!3scn!5e1105!12m4!1e68!2m2!1sset!2sRoadmap!4e0!5m1!1e0";var E=void 0;var S=i("p8Td"),D=i("qxxq");var P={name:"Map",mounted:function(){var e=this.$refs.myMap;this.initMap(e),this.resize(),document.body.onresize=this.resize.bind(this)},data:function(){return{active:0,isButtonDisabled:!1,isShowLoading:!1}},methods:{previous:function(){this.active<0&&(this.active=3)},next:function(){this.active++>3&&(this.active=0)},initMap:function(e){var t=this.map=function(e){return new r.a({layers:[new l.a({source:new u.a({attributions:new b.a({html:"地图数据 © 2018 Google"}),url:y})})],target:e,controls:d.a.defaults({attributionOptions:{collapsible:!1}}),view:new c.a({center:[12685153.492296234,2577384.2465164554],zoom:12})})}(e),i=function(e){var t=new w.a;return{source:t,vector:new h.a({source:t,style:new A.a({fill:new g.a({color:"rgba(255, 255, 255, 0.2)"}),stroke:new p.a({color:"#ffcc33",width:2}),image:new v.a({anchor:[.5,1],anchorXUnits:"fraction",anchorYUnits:"fraction",size:[32,32],src:k.a})})})}}(),a=i.vector,n=i.source,s=function(){var e=new w.a,t=new A.a({image:new v.a({anchor:[.5,1],anchorXUnits:"fraction",anchorYUnits:"fraction",size:[32,32],src:B.a})}),i=new A.a({text:new m.a({font:'bold 11px "Open Sans", "Arial Unicode MS", "sans-serif"',placement:"point",offsetY:-40,fill:new g.a({color:"#2f2f2f"})})}),a=new h.a({source:e,style:t}),n=new w.a;return{markers:a,markerSource:e,textMarkers:new h.a({declutter:!0,source:n,style:function(e){return i.getText().setText(e.get("name")),i}}),textSource:n}}(),o=s.markers,f=s.markerSource,x=s.textMarkers,U=s.textSource;this.vector=a,this.source=n,this.markers=o,this.markerSource=f,this.textMarkers=x,this.textSource=U,t.addLayer(a),t.addLayer(o),t.addLayer(x)},resize:function(){var e=window.innerWidth,t=window.innerHeight;this.map.setSize([e,t])},showLoading:function(){this.isButtonDisabled=!0,this.isShowLoading=!0},hideLoading:function(){this.isButtonDisabled=!1,this.isShowLoading=!1},drawPoint:function(){var e=this,t=!this.draw;this.draw=function(e,t){if(E)return E;var i=new A.a({fill:new g.a({color:"rgba(255, 255, 255, 0.2)"}),stroke:new p.a({color:"#ffcc33",width:2}),image:new v.a({anchor:[.5,1],anchorXUnits:"fraction",anchorYUnits:"fraction",size:[32,32],src:B.a})});return E=new f.a({source:t,style:i,type:"Point"}),e.addInteraction(E),E}(this.map,this.source),this.draw.setActive(!0),this.showLoading(),this.$message("请在地图上标三个点以上"),t&&this.draw.on("drawend",function(){var t=e.source.getFeatures();t&&t.length>=2&&(e.hideLoading(),e.$message("现在可以下一步查询三个点中间的美食点"))})},searchPoi:function(){var e=this;this.draw&&this.draw.setActive(!1),this.showLoading(),function(e){if(e&&!(e.length<1)){for(var t=[],i=0,a=e.length;i<a;i++){var n=e[i].getGeometry().clone().transform("EPSG:3857","EPSG:4326");t.push(n.getCoordinates().map(function(e){return e.toFixed(6)}).join(","))}return t.push(t[0]),t=t.join("|"),fetch("//restapi.amap.com/v3/place/polygon?key=c673e715513d38b5dd75564d8ec4f717&types=050000&polygon="+t+"&keywords=美食&output=json&offset=25&page=1").then(function(e){if(console.log(e),e.status>=200&&e.status<400)return e.json()})}}(this.source.getFeatures()).then(function(t){e.markerSource.clear(),e.textSource.clear();var i=t.pois;for(var a in i){var n=i[a].location.split(","),s=new D.a([+n[0],+n[1]]);s=s.transform("EPSG:4326","EPSG:3857");var o=new S.a({geometry:s,labelPoint:s.clone(),name:i[a].name});e.markerSource.addFeature(o),e.textSource.addFeature(o.clone())}e.hideLoading(),e.$message("请下一步查询离三个点都比较近的美食点")})},clear:function(){this.draw&&this.draw.setActive(!1),this.source.clear(),this.markerSource.clear(),this.textSource.clear(),this.active=0,this.draw.un("drawend")},findBestPlace:function(){this.draw&&this.draw.setActive(!1),this.$message("正在开发中...")}},watch:{active:function(e){switch(e){case 1:this.drawPoint();break;case 2:this.searchPoi();break;case 3:this.findBestPlace();break;default:this.hideLoading(),this.clear()}}}},R={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{ref:"myMap",attrs:{id:"map"}},[i("div",{staticClass:"step-tools"},[i("el-steps",{attrs:{active:e.active}},[i("el-step",{attrs:{title:"开始",icon:"el-icon-time"}}),e._v(" "),i("el-step",{attrs:{title:"标位置",icon:"el-icon-location"}}),e._v(" "),i("el-step",{attrs:{title:"搜索Poi",icon:"el-icon-search"}}),e._v(" "),i("el-step",{attrs:{title:"找最优点",icon:"el-icon-success"}})],1),e._v(" "),i("el-button",{staticStyle:{"margin-top":"12px"},attrs:{disabled:e.isButtonDisabled},on:{click:e.previous}},[e._v("上一步")]),e._v(" "),i("el-button",{staticStyle:{"margin-top":"12px"},attrs:{disabled:e.isButtonDisabled},on:{click:e.next}},[e._v("下一步")]),e._v(" "),i("el-button",{attrs:{type:"info",icon:"el-icon-delete"},on:{click:e.clear}}),e._v(" "),e.isShowLoading?i("i",{staticClass:"el-icon-loading loading-icon"}):e._e()],1)])},staticRenderFns:[]};var C=i("VU/8")(P,R,!1,function(e){i("PVbU")},"data-v-68050f70",null).exports;a.default.use(o.a);var G=new o.a({routes:[{path:"/",name:"Map",component:C}]}),L={render:function(){var e=this.$createElement,t=this._self._c||e;return t("el-container",[t("el-main",[t("router-view")],1)],1)},staticRenderFns:[]};var M=i("VU/8")({name:"App"},L,!1,function(e){i("5Ejt")},null,null).exports;a.default.use(s.a,{size:"small"}),a.default.config.productionTip=!1,new a.default({el:"#app",router:G,components:{App:M},template:"<App/>"})},PVbU:function(e,t){},ktr9:function(e,t){},tYJ7:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAACEUlEQVR42u2XyyvEURTHvSeS8loYjyF7IgvPskUsERvyF4hiJxHJY2FjzSwQCxZKFoRk4REbLMYC5VGUUB7j9b31VdOv+/vN3Pnd386tz+bOued8u+fOOecXEfG/wlspoAI0kHLuOb5cYAA8Aj/4JH7u9YM4p4JXgUPwE4R9UKY7eBF4DiH4H0+gQFfwKLADvhUECNsNXQLaTYJ8gVvyZWLTbDd4LNiWOBYPrwvkkW7uGe3WQbQdAWnAJ7neKYntlCRNZyDZjoBMcCm5+haJbatEwAVw2xGQDs4lN9Ajse2VCPDRh63CcyDJ7T3IApEki3tGuwMdhWnU5IU/gBXyYGIzrONvmA/eFWrAH+JMjq5aMBeGgBmdpbgavCkEfwWVOgWIgrSpIGANxOhuSB5wF0Lwa5DhVEvuDUFAp5MDiSirexbBRZqSdAZMYDf0BhSUFJNUXIFE2sTxTBuIDzd4Cdhll1ugGKsW3WgQvsizwkexavBUcMpZb9DEZpK/f3BOlK0hijihT6XH9s0X7bFIzypvx2Vikwtu6KtLRYCX1/oCaoJ0S6tHV0cfwte0ioD6gNb6zMcUqXBe2HYEBBe+alXb8LxhCDliZxTDSCmbVDbJ554YSsbBsWFOnLVIk+UaYw9QmYgDBxfRE0bsjuRF/OI54qsPFtjPD5g+UKiYuqDLzRRMgGWwRZZ4W01O9gFH1i9fvisTPvOjLAAAAABJRU5ErkJggg=="},tvR6:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.4529e68e041531471925.js.map