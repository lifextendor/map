webpackJsonp([1],{"6UtM":function(t,e){},Ib2a:function(t,e){},NHnr:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n("7+uW"),i=n("zL8q"),o=n.n(i),r=(n("tvR6"),n("/ocq")),s=n("9bGr"),c=n("gCHX"),l=n("L2CZ"),u=n("1Cty"),d=n("aC3Q"),h=n("eM/O"),p=n("bdNf"),f=n("86p+"),w=n("tOEd"),m=n("6HMI"),v=n("lY9i"),g=n("HWXU"),b=n("oj2/"),x=(n("ktr9"),"//www.google.cn/maps/vt/pb=!1m4!1m3!1i{z}!2i{x}!3i{y}!2m3!1e0!2sm!3i380072576!3m8!2szh-CN!3scn!5e1105!12m4!1e68!2m2!1sset!2sRoadmap!4e0!5m1!1e0"),S="E901",k="E902";var y=void 0;var C=n("p8Td"),L=n("qxxq");var _={name:"Map",mounted:function(){var t=this.$refs.myMap;this.initMap(t),this.resize(),document.body.onresize=this.resize.bind(this)},data:function(){return{active:0,isButtonDisabled:!1,isShowLoading:!1}},methods:{previous:function(){this.active<0&&(this.active=3)},next:function(){this.active++>3&&(this.active=0)},initMap:function(t){var e=this.map=function(t){return new s.a({layers:[new l.a({source:new u.a({attributions:new b.a({html:"地图数据 © 2018 Google"}),url:x})})],target:t,controls:h.a.defaults({attributionOptions:{collapsible:!1}}),view:new c.a({center:[12685153.492296234,2577384.2465164554],zoom:12})})}(t),n=function(t){var e=new w.a({text:new g.a({font:'bold 24px "map-tools-icons"',placement:"point",offsetY:-12,fill:new m.a({color:"#CC0033"}),stroke:new v.a({color:"white",width:2}),text:String.fromCharCode(parseInt(k,16))})}),n=new f.a;return{source:n,vector:new d.a({source:n,style:e})}}(),a=n.vector,i=n.source,o=function(){var t=new f.a,e=new w.a({text:new g.a({font:'bold 24px "map-tools-icons"',placement:"point",offsetY:-12,fill:new m.a({color:"#CC0000"}),stroke:new v.a({color:"white",width:2}),text:String.fromCharCode(parseInt(S,16))})}),n=new w.a({text:new g.a({font:'bold 11px "Open Sans", "Arial Unicode MS", "sans-serif"',placement:"point",offsetY:-30,fill:new m.a({color:"#660000"})})}),a=new d.a({source:t,style:e}),i=new f.a;return{markers:a,markerSource:t,textMarkers:new d.a({declutter:!0,source:i,style:function(t){return n.getText().setText(t.get("name")),n}}),textSource:i}}(),r=o.markers,p=o.markerSource,y=o.textMarkers,C=o.textSource;this.vector=a,this.source=i,this.markers=r,this.markerSource=p,this.textMarkers=y,this.textSource=C,e.addLayer(a),e.addLayer(r),e.addLayer(y)},resize:function(){var t=window.innerWidth,e=window.innerHeight;this.map.setSize([t,e])},showLoading:function(){this.isButtonDisabled=!0,this.isShowLoading=!0},hideLoading:function(){this.isButtonDisabled=!1,this.isShowLoading=!1},drawPoint:function(){var t=this,e=!this.draw;this.draw=function(t,e){if(y)return y;var n=new w.a({text:new g.a({font:'bold 24px "map-tools-icons"',placement:"point",offsetY:-12,fill:new m.a({color:"#CC0033"}),stroke:new v.a({color:"white",width:2}),text:String.fromCharCode(parseInt(S,16))})});return y=new p.a({source:e,style:n,type:"Point"}),t.addInteraction(y),y}(this.map,this.source),this.draw.setActive(!0),this.showLoading(),this.$message("请在地图上标三个点以上"),e&&this.draw.on("drawend",function(){var e=t.source.getFeatures();e&&e.length>=2&&(t.hideLoading(),t.$message("现在可以下一步查询三个点中间的美食点"))})},searchPoi:function(){var t=this;this.draw&&this.draw.setActive(!1),this.showLoading(),function(t){if(t&&!(t.length<1)){for(var e=[],n=0,a=t.length;n<a;n++){var i=t[n].getGeometry().clone().transform("EPSG:3857","EPSG:4326");e.push(i.getCoordinates().map(function(t){return t.toFixed(6)}).join(","))}return e.push(e[0]),e=e.join("|"),fetch("//restapi.amap.com/v3/place/polygon?key=c673e715513d38b5dd75564d8ec4f717&types=050000&polygon="+e+"&keywords=美食&output=json&offset=25&page=1").then(function(t){if(console.log(t),t.status>=200&&t.status<400)return t.json()})}}(this.source.getFeatures()).then(function(e){t.markerSource.clear(),t.textSource.clear();var n=e.pois;for(var a in n){var i=n[a].location.split(","),o=new L.a([+i[0],+i[1]]);o=o.transform("EPSG:4326","EPSG:3857");var r=new C.a({geometry:o,labelPoint:o.clone(),name:n[a].name});t.markerSource.addFeature(r),t.textSource.addFeature(r.clone())}t.hideLoading(),t.$message("请下一步查询离三个点都比较近的美食点")})},clear:function(){this.draw&&this.draw.setActive(!1),this.source.clear(),this.markerSource.clear(),this.textSource.clear(),this.active=0,this.draw.un("drawend")},findBestPlace:function(){this.draw&&this.draw.setActive(!1),this.$message("正在开发中...")}},watch:{active:function(t){switch(t){case 1:this.drawPoint();break;case 2:this.searchPoi();break;case 3:this.findBestPlace();break;default:this.hideLoading(),this.clear()}}}},M={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"myMap",attrs:{id:"map"}},[n("div",{staticClass:"step-tools"},[n("el-steps",{attrs:{active:t.active}},[n("el-step",{attrs:{title:"开始",icon:"el-icon-time"}}),t._v(" "),n("el-step",{attrs:{title:"标位置",icon:"map-tools-icons-map-marker-radius"}}),t._v(" "),n("el-step",{attrs:{title:"搜索Poi",icon:"el-icon-search"}}),t._v(" "),n("el-step",{attrs:{title:"找最优点",icon:"el-icon-success"}})],1),t._v(" "),n("el-button",{staticStyle:{"margin-top":"12px"},attrs:{disabled:t.isButtonDisabled},on:{click:t.previous}},[t._v("上一步")]),t._v(" "),n("el-button",{staticStyle:{"margin-top":"12px"},attrs:{disabled:t.isButtonDisabled},on:{click:t.next}},[t._v("下一步")]),t._v(" "),n("el-button",{attrs:{type:"info",icon:"el-icon-delete"},on:{click:t.clear}}),t._v(" "),t.isShowLoading?n("i",{staticClass:"el-icon-loading loading-icon"}):t._e()],1)])},staticRenderFns:[]};var P=n("VU/8")(_,M,!1,function(t){n("6UtM")},"data-v-3aa1a63b",null).exports;a.default.use(r.a);var E=new r.a({routes:[{path:"/",name:"Map",component:P}]}),z={render:function(){var t=this.$createElement,e=this._self._c||t;return e("el-container",[e("el-main",[e("router-view")],1)],1)},staticRenderFns:[]};var A=n("VU/8")({name:"App"},z,!1,function(t){n("Ib2a")},null,null).exports;n("n7EU");a.default.use(o.a,{size:"small"}),a.default.config.productionTip=!1,new a.default({el:"#app",router:E,components:{App:A},template:"<App/>"})},ktr9:function(t,e){},n7EU:function(t,e){},tvR6:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.82bd8e4bd23a58314b3b.js.map