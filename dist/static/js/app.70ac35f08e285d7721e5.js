webpackJsonp([1],{Ib2a:function(e,t){},NHnr:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i("7+uW"),a=i("zL8q"),n=i.n(a),s=(i("tvR6"),i("/ocq")),r=i("9bGr"),l=i("gCHX"),c=i("L2CZ"),u=i("1Cty"),d=i("aC3Q"),h=i("eM/O"),p=i("bdNf"),f=i("86p+"),m=i("tOEd"),v=i("6HMI"),w=i("lY9i"),b=i("HWXU"),g=i("oj2/"),x=(i("ktr9"),"//www.google.cn/maps/vt/pb=!1m4!1m3!1i{z}!2i{x}!3i{y}!2m3!1e0!2sm!3i380072576!3m8!2szh-CN!3scn!5e1105!12m4!1e68!2m2!1sset!2sRoadmap!4e0!5m1!1e0"),y="E901",k="E902";var S=void 0;var C=i("p8Td"),_=i("qxxq");var L={name:"Map",mounted:function(){var e=this.$refs.myMap;this.initMap(e),this.resize(),document.body.onresize=this.resize.bind(this)},data:function(){return{active:0,isButtonDisabled:!1,isShowLoading:!1,type:"1",dialogFormVisible:!1}},methods:{previous:function(){this.active<0&&(this.active=3)},next:function(){this.active++>3&&(this.active=0)},initMap:function(e){var t=this.map=function(e){return new r.a({layers:[new c.a({source:new u.a({attributions:new g.a({html:"地图数据 © 2018 Google"}),url:x})})],target:e,controls:h.a.defaults({attributionOptions:{collapsible:!1}}),view:new l.a({center:[12685153.492296234,2577384.2465164554],zoom:12})})}(e),i=function(e){var t=new m.a({text:new b.a({font:'bold 24px "map-tools-icons"',placement:"point",offsetY:-12,fill:new v.a({color:"#CC0033"}),stroke:new w.a({color:"white",width:2}),text:String.fromCharCode(parseInt(k,16))})}),i=new f.a;return{source:i,vector:new d.a({source:i,style:t})}}(),o=i.vector,a=i.source,n=function(){var e=new f.a,t=new m.a({text:new b.a({font:'bold 24px "map-tools-icons"',placement:"point",offsetY:-12,fill:new v.a({color:"#CC0000"}),stroke:new w.a({color:"white",width:2}),text:String.fromCharCode(parseInt(y,16))})}),i=new m.a({text:new b.a({font:'bold 11px "Open Sans", "Arial Unicode MS", "sans-serif"',placement:"point",offsetY:-30,fill:new v.a({color:"#660000"})})}),o=new d.a({source:e,style:t}),a=new f.a;return{markers:o,markerSource:e,textMarkers:new d.a({declutter:!0,source:a,style:function(e){return i.getText().setText(e.get("name")),i}}),textSource:a}}(),s=n.markers,p=n.markerSource,S=n.textMarkers,C=n.textSource;this.vector=o,this.source=a,this.markers=s,this.markerSource=p,this.textMarkers=S,this.textSource=C,t.addLayer(o),t.addLayer(s),t.addLayer(S)},resize:function(){var e=window.innerWidth,t=window.innerHeight;this.map.setSize([e,t])},showLoading:function(){this.isButtonDisabled=!0,this.isShowLoading=!0},hideLoading:function(){this.isButtonDisabled=!1,this.isShowLoading=!1},drawPoint:function(){var e=this,t=!this.draw;this.draw=function(e,t){if(S)return S;var i=new m.a({text:new b.a({font:'bold 24px "map-tools-icons"',placement:"point",offsetY:-12,fill:new v.a({color:"#CC0033"}),stroke:new w.a({color:"white",width:2}),text:String.fromCharCode(parseInt(y,16))})});return S=new p.a({source:t,style:i,type:"Point"}),e.addInteraction(S),S}(this.map,this.source),this.draw.setActive(!0),this.showLoading(),this.$message("请在地图上标三个点以上"),t&&this.draw.on("drawend",function(){var t=e.source.getFeatures();t&&t.length>=2&&(e.hideLoading(),e.$message("现在可以下一步查询三个点中间的美食点"))})},searchPoi:function(){var e=this;this.draw&&this.draw.setActive(!1),this.showLoading(),function(e){if(e&&!(e.length<1)){for(var t=[],i=0,o=e.length;i<o;i++){var a=e[i].getGeometry().clone().transform("EPSG:3857","EPSG:4326");t.push(a.getCoordinates().map(function(e){return e.toFixed(6)}).join(","))}return t.push(t[0]),t=t.join("|"),fetch("//restapi.amap.com/v3/place/polygon?key=c673e715513d38b5dd75564d8ec4f717&types=050000&polygon="+t+"&keywords=美食&output=json&offset=25&page=1").then(function(e){if(console.log(e),e.status>=200&&e.status<400)return e.json()})}}(this.source.getFeatures()).then(function(t){e.markerSource.clear(),e.textSource.clear();var i=t.pois;for(var o in i){var a=i[o].location.split(","),n=new _.a([+a[0],+a[1]]);n=n.transform("EPSG:4326","EPSG:3857");var s=new C.a({geometry:n,labelPoint:n.clone(),name:i[o].name});e.markerSource.addFeature(s),e.textSource.addFeature(s.clone())}e.hideLoading(),e.$message("请下一步查询离三个点都比较近的美食点")})},clear:function(){this.draw&&this.draw.setActive(!1),this.source.clear(),this.markerSource.clear(),this.textSource.clear(),this.active=0,this.draw.un("drawend")},findBestPlace:function(){this.draw&&this.draw.setActive(!1),this.dialogFormVisible=!0},onDialogClose:function(){this.$message("正在开发中...")}},watch:{active:function(e){switch(e){case 1:this.drawPoint();break;case 2:this.searchPoi();break;case 3:this.findBestPlace();break;default:this.hideLoading(),this.clear()}}}},P={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{ref:"myMap",attrs:{id:"map"}},[i("div",{staticClass:"step-tools"},[i("el-steps",{attrs:{active:e.active}},[i("el-step",{attrs:{title:"开始",icon:"el-icon-time"}}),e._v(" "),i("el-step",{attrs:{title:"标位置",icon:"map-tools-icons-map-marker-radius"}}),e._v(" "),i("el-step",{attrs:{title:"搜索Poi",icon:"el-icon-search"}}),e._v(" "),i("el-step",{attrs:{title:"找最优点",icon:"el-icon-success"}})],1),e._v(" "),i("el-button",{staticStyle:{"margin-top":"12px"},attrs:{disabled:e.isButtonDisabled},on:{click:e.previous}},[e._v("上一步")]),e._v(" "),i("el-button",{staticStyle:{"margin-top":"12px"},attrs:{disabled:e.isButtonDisabled},on:{click:e.next}},[e._v("下一步")]),e._v(" "),i("el-button",{attrs:{type:"info",icon:"el-icon-delete"},on:{click:e.clear}}),e._v(" "),e.isShowLoading?i("i",{staticClass:"el-icon-loading loading-icon"}):e._e()],1),e._v(" "),i("el-dialog",{attrs:{title:"参数设置",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t},close:e.onDialogClose}},[i("el-form",[i("el-form-item",{attrs:{label:"路径类型","label-width":e.formLabelWidth}},[i("el-select",{attrs:{placeholder:"请选择路径类型"},model:{value:e.type,callback:function(t){e.type=t},expression:"type"}},[i("el-option",{attrs:{label:"驾车",value:"1"}}),e._v(" "),i("el-option",{attrs:{label:"公交",value:"2"}}),e._v(" "),i("el-option",{attrs:{label:"步行",value:"3"}})],1)],1)],1),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var F=i("VU/8")(L,P,!1,function(e){i("blbb")},"data-v-5c087374",null).exports;o.default.use(s.a);var M=new s.a({routes:[{path:"/",name:"Map",component:F}]}),E={render:function(){var e=this.$createElement,t=this._self._c||e;return t("el-container",[t("el-main",[t("router-view")],1)],1)},staticRenderFns:[]};var z=i("VU/8")({name:"App"},E,!1,function(e){i("Ib2a")},null,null).exports;i("n7EU");o.default.use(n.a,{size:"small"}),o.default.config.productionTip=!1,new o.default({el:"#app",router:M,components:{App:z},template:"<App/>"})},blbb:function(e,t){},ktr9:function(e,t){},n7EU:function(e,t){},tvR6:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.70ac35f08e285d7721e5.js.map